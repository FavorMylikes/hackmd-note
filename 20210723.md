# Daily New

## 准备看点Coursera

- week 3
  - [2-d-quadrotor-control](https://www.coursera.org/learn/robotics-flight/lecture/kakc6/2-d-quadrotor-control)
    - state-space form[状态空间]
      - Identify the order, n, of the system
      - Define the states, $x=y(t), x_1 = \dot y(t) \dotsc$
      - Create the states vector, $\mathbf{x} = [x_1, x_2, \dotsc ]^T = [y, \dot y, \dotsc ]^T$
      - write system of first-order differencial equations as matrix.
      - $$\begin{bmatrix}
          \dot x_1\\
          \dot x_2\\
          \dotsc\\
          \dot x_n
          \end{bmatrix}
          =
          \begin{bmatrix}
              x_2\\
              x_3\\
              \dotsc\\
              g(x_1, x_2, \dotsc, x_n, \mathbf{u})
          \end{bmatrix}
        $$
      - $\mathbf{\dot x} = f(\mathbf{x}, \mathbf{u})$
    - example 1[**Mass-Spring System**]
      - for equation $m\ddot y(t) + ky(t) = u(t)$
      - $$\dot x=\begin{bmatrix}\dot x_1\\ \dot x_2\end{bmatrix} = \begin{bmatrix}x_2\\\frac{u(t)-kx_1}{m}\end{bmatrix}=\begin{bmatrix}0&1\\-\frac{k}{m}&0\end{bmatrix}\begin{bmatrix}x_1\\x_2\end{bmatrix} + \begin{bmatrix}0\\1\end{bmatrix}u(t)$$
      - $\mathbf{\dot X}=A\mathbf{X}+B\mathbf{u}$
    - example 2[**Planar Quadrotor Model**]
      - Define states $x_1 = y,x_2 = z, x_3 = \phi, x_4 = \dot y, x_5 = \dot z, x_6 = \dot \phi$
      - $$
            \begin{aligned}
            m\ddot y &= sin(\phi) u_1\\
            m\ddot z &= cos(\phi) u_1 + mg\\
            I_{xx} \ddot \phi &= u_2
            \end{aligned}
        $$
      - $$
            \begin{bmatrix}
            \dot x_1\\
            \dot x_2\\
            \dot x_3\\
            \dot x_4\\
            \dot x_5\\
            \dot x_6\\
            \end{bmatrix}
            =
            \begin{bmatrix}
            x_4\\
            x_5\\
            x_6\\
            \frac{\sin(x_3)u_1}{m}\\
            \frac{\cos(x_3)u_1}{m} - g\\
            u_2
            \end{bmatrix}
        $$
  - **Linearization**
    - **For PID controller, it is designed for a linear system**
    - **So, we need linearize equation of motions.**
  - For 2D Quadrotor Control
    - ![20210723122620](https://raw.githubusercontent.com/FavorMylikes/hackmd-note/img/img/20210723122620.png)
    - Rotation matrix
      - $\begin{bmatrix}\cos\phi& -\sin\phi\\\sin\phi&\cos\phi \end{bmatrix}$
    - $u_1=F_1 +F_2$
    - $u_2 = L(F_1 - F_2)$
      - L is the arm length of the quadrotor.
    - Newton equation
      - $m\mathbf{\ddot r}=m\begin{bmatrix}\ddot y\\\ddot z\end{bmatrix}=\begin{bmatrix}0\\-mg\end{bmatrix} + R\begin{bmatrix}0\\u_1\end{bmatrix} = \begin{bmatrix}0\\-mg\end{bmatrix} + \begin{bmatrix}-u_1\sin\phi\\u_1\cos\phi\end{bmatrix}$
    - Euler equation
      - $I_{xx}\ddot \phi = u_2$
    - Newton-Euler equation
      - $\begin{bmatrix}\ddot y\\\ddot z\\\ddot\phi\end{bmatrix}=\begin{bmatrix}0\\-g\\0\end{bmatrix} + \begin{bmatrix}
          -\frac{1}{m}\sin\phi&0\\
          \frac{1}{m}\cos\phi&0\\
          0&\frac{1}{I_{xx}}
      \end{bmatrix}
      \begin{bmatrix}
        u_1\\u_2
      \end{bmatrix}
      $
    - Linearization
      - $\phi\sim 0 \rightarrow \sin\phi\sim \phi, \cos\phi\sim 1$
      - $$
            \begin{aligned}
            \ddot y &= -g\phi\\
            \ddot z &= -g + \frac{u_1}{m}\\
            \ddot \phi &=\frac{u_2}{I_{xx}}
            \end{aligned}
        $$
    - PD controller
      - $$\begin{aligned}e_p&=r_T(t)-r\\e_v&=\dot r_T(t) - \dot r\end{aligned}$$
      - $\ddot r_c=\ddot r_T(t) + k_pe_p+k_ve_v$
      - $$
            \begin{aligned}
                u_1&=mg+m\ddot z_c&=&m[g+\ddot z_T(t)+k_{vz}(\dot z_T(t) - \dot z) + k_{pz}(z_T(t)-z)]\\
                u_2&=I_{xx}\ddot \phi_c &=& I_{xx}[\ddot \phi_T(t)+ k_{v\phi}(\dot\phi_T(t) - \dot\phi) + k_{pz}(\phi_T(t) - \phi)]\\
                \phi_c &= -\frac{\ddot y_c}{g} &=& -\frac{1}{g}[\ddot y_T(t) + k_{vy}(\dot y_T(t) - \dot y) + k_{py}(y_T(t)-y)]
            \end{aligned}
        $$